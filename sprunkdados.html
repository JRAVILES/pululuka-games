<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Corrida Sprunk - Jogo de Percurso</title>
    <style>
      :root {
        color-scheme: light;
        --violeta: #7b5dff;
        --rosa: #ff7bb0;
        --verde: #33dfb0;
        --azul: #44bfff;
        --amarelo: #ffe766;
        --laranja: #ffb347;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: 'Poppins', Arial, sans-serif;
        background: radial-gradient(circle at 15% 20%, #fff5fb, #ffeab3 70%);
        margin: 0;
        padding: clamp(4px, 1vw, 8px);
        color: #1a1030;
      }

      h1 {
        text-align: center;
        margin: 0;
        color: #3c1768;
      }

      .descricao,
      .tag-percurso {
        text-align: center;
        margin: 6px auto;
        max-width: 90%;
        color: #4a2c75;
      }

      .tag-percurso strong {
        color: #ff4085;
      }

      .setup {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 60px;
        background: rgba(255, 255, 255, 0.9);
        padding: clamp(12px, 2vw, 20px);
        border-radius: 22px;
        border: 1px solid rgba(255, 255, 255, 0.7);
        box-shadow: 0 16px 40px rgba(114, 76, 213, 0.16);
        max-width: 90%;
        margin: 0 auto 20px;
      }

      .setup.hidden {
        display: none;
      }

      .player-config h2 {
        margin: 0 0 4px;
      }

      .player-config p {
        margin: 0 0 10px;
        color: #5d4389;
        font-size: 14px;
      }

      .personagem-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }

      .personagem-card {
        border: 2px solid transparent;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.9);
        padding: 8px;
        display: flex;
        flex-direction: column;
        gap: 6px;
        align-items: center;
        cursor: pointer;
        transition: transform 0.2s ease, border 0.2s ease, box-shadow 0.2s ease;
        min-height: 130px;
      }

      .personagem-card img {
        width: 64px;
        height: 64px;
        object-fit: contain;
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25));
      }

      .personagem-card strong {
        font-size: 14px;
      }

      .personagem-card small {
        font-size: 11px;
        color: #6a4b90;
      }

      .personagem-card.selected {
        border-color: var(--verde);
        box-shadow: 0 0 14px rgba(51, 223, 176, 0.5);
        transform: translateY(-3px);
      }

      .personagem-card.bloqueado {
        opacity: 0.35;
        cursor: not-allowed;
      }

      .preview-card {
        margin-top: 8px;
        padding: 10px;
        border-radius: 16px;
        border: 1px dashed rgba(0, 0, 0, 0.1);
        display: flex;
        gap: 8px;
        align-items: center;
        min-height: 70px;
        background: rgba(255, 255, 255, 0.7);
      }

      .preview-card img {
        width: 56px;
        height: 56px;
        object-fit: contain;
        border-radius: 12px;
        background: rgba(0, 0, 0, 0.04);
        padding: 4px;
      }

      .setup-actions {
        grid-column: 1 / -1;
        display: flex;
        justify-content: center;
        padding-top: 4px;
      }

      button {
        cursor: pointer;
        border: none;
        border-radius: 14px;
        padding: 12px 26px;
        font-size: 16px;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      #iniciarJogo {
        background: linear-gradient(135deg, var(--rosa), var(--violeta));
        color: #fff;
        min-width: 200px;
      }

      #iniciarJogo:not(:disabled):hover,
      #rolarDados:not(:disabled):hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 16px rgba(0, 0, 0, 0.15);
      }

      .painel-principal {
        max-width: 90%;
        margin: 0 auto;
        display: grid;
        gap: 18px;
      }

      .painel-principal.hidden {
        display: none;
      }

      .acoes {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        align-items: center;
        padding: 16px;
        border-radius: 18px;
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 18px 28px rgba(122, 93, 255, 0.12);
      }

      #rolarDados {
        background: linear-gradient(135deg, var(--verde), var(--azul));
        color: #083436;
      }

      .dado-visivel {
        width: 84px;
        height: 84px;
        border-radius: 22px;
        background: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 34px;
        font-weight: 600;
        box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.08);
      }

      .game-area {
        display: grid;
        grid-template-columns: minmax(220px, 280px) minmax(520px, 1fr);
        gap: 14px;
      }

      .mapa-wrapper {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 30px;
        padding: clamp(10px, 2vw, 20px);
        border: 1px solid rgba(255, 255, 255, 0.7);
        box-shadow: 0 25px 35px rgba(79, 52, 170, 0.18);
      }

      .mapa-real {
        position: relative;
        width: 100%;
        aspect-ratio: 4 / 3;
        border-radius: 26px;
        background: radial-gradient(
          circle at 20% 25%,
          rgba(255, 255, 255, 0.65),
          rgba(255, 255, 255, 0.35)
        );
        overflow: hidden;
        padding: 20px 20px 40px 20px;
      }

      #tabuleiro {
        position: relative;
        width: 100%;
        height: 100%;
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 10px;
        align-content: start;
      }

      /* Posicionamento em zigue-zague */
      /* Linha 1: 1-5 (esquerda para direita) */
      .casa:nth-child(1) {
        grid-row: 1;
        grid-column: 1;
      }
      .casa:nth-child(2) {
        grid-row: 1;
        grid-column: 2;
      }
      .casa:nth-child(3) {
        grid-row: 1;
        grid-column: 3;
      }
      .casa:nth-child(4) {
        grid-row: 1;
        grid-column: 4;
      }
      .casa:nth-child(5) {
        grid-row: 1;
        grid-column: 5;
      }

      /* Linha 2: 6-10 (direita para esquerda) */
      .casa:nth-child(6) {
        grid-row: 2;
        grid-column: 5;
      }
      .casa:nth-child(7) {
        grid-row: 2;
        grid-column: 4;
      }
      .casa:nth-child(8) {
        grid-row: 2;
        grid-column: 3;
      }
      .casa:nth-child(9) {
        grid-row: 2;
        grid-column: 2;
      }
      .casa:nth-child(10) {
        grid-row: 2;
        grid-column: 1;
      }

      /* Linha 3: 11-15 (esquerda para direita) */
      .casa:nth-child(11) {
        grid-row: 3;
        grid-column: 1;
      }
      .casa:nth-child(12) {
        grid-row: 3;
        grid-column: 2;
      }
      .casa:nth-child(13) {
        grid-row: 3;
        grid-column: 3;
      }
      .casa:nth-child(14) {
        grid-row: 3;
        grid-column: 4;
      }
      .casa:nth-child(15) {
        grid-row: 3;
        grid-column: 5;
      }

      /* Linha 4: 16-20 (direita para esquerda) */
      .casa:nth-child(16) {
        grid-row: 4;
        grid-column: 5;
      }
      .casa:nth-child(17) {
        grid-row: 4;
        grid-column: 4;
      }
      .casa:nth-child(18) {
        grid-row: 4;
        grid-column: 3;
      }
      .casa:nth-child(19) {
        grid-row: 4;
        grid-column: 2;
      }
      .casa:nth-child(20) {
        grid-row: 4;
        grid-column: 1;
      }

      /* Linha 5: 21-25 (esquerda para direita) */
      .casa:nth-child(21) {
        grid-row: 5;
        grid-column: 1;
      }
      .casa:nth-child(22) {
        grid-row: 5;
        grid-column: 2;
      }
      .casa:nth-child(23) {
        grid-row: 5;
        grid-column: 3;
      }
      .casa:nth-child(24) {
        grid-row: 5;
        grid-column: 4;
      }
      .casa:nth-child(25) {
        grid-row: 5;
        grid-column: 5;
      }

      /* Linha 6: 26-30 (direita para esquerda) */
      .casa:nth-child(26) {
        grid-row: 6;
        grid-column: 5;
      }
      .casa:nth-child(27) {
        grid-row: 6;
        grid-column: 4;
      }
      .casa:nth-child(28) {
        grid-row: 6;
        grid-column: 3;
      }
      .casa:nth-child(29) {
        grid-row: 6;
        grid-column: 2;
      }
      .casa:nth-child(30) {
        grid-row: 6;
        grid-column: 1;
      }

      /* Linha 7: 31-35 (esquerda para direita) */
      .casa:nth-child(31) {
        grid-row: 7;
        grid-column: 1;
      }
      .casa:nth-child(32) {
        grid-row: 7;
        grid-column: 2;
      }
      .casa:nth-child(33) {
        grid-row: 7;
        grid-column: 3;
      }
      .casa:nth-child(34) {
        grid-row: 7;
        grid-column: 4;
      }
      .casa:nth-child(35) {
        grid-row: 7;
        grid-column: 5;
      }

      /* Linha 8: 36-40 (direita para esquerda) */
      .casa:nth-child(36) {
        grid-row: 8;
        grid-column: 5;
      }
      .casa:nth-child(37) {
        grid-row: 8;
        grid-column: 4;
      }
      .casa:nth-child(38) {
        grid-row: 8;
        grid-column: 3;
      }
      .casa:nth-child(39) {
        grid-row: 8;
        grid-column: 2;
      }
      .casa:nth-child(40) {
        grid-row: 8;
        grid-column: 1;
      }

      .casa {
        position: relative;
        padding: 10px;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.96);
        border: 4px solid rgba(255, 200, 100, 0.7);
        font-size: 11px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height: 100px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s ease;
      }

      .casa:hover {
        transform: translateY(-2px);
      }

      /* Borda com cor do jogador - um jogador */
      .casa.jogador-presente-1 {
        border-width: 5px;
        animation: pulse 2s ease-in-out infinite;
      }

      /* Borda dividida - dois jogadores */
      .casa.jogador-presente-2 {
        border-width: 5px;
        position: relative;
        animation: pulse 2s ease-in-out infinite;
      }

      /* Cria efeito de divis√£o diagonal quando h√° dois jogadores */
      .casa.jogador-presente-2::before {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: 50%;
        bottom: 50%;
        border-radius: 16px 0 0 0;
        pointer-events: none;
        z-index: -1;
      }

      @keyframes pulse {
        0%,
        100% {
          box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3), 0 0 20px rgba(0, 0, 0, 0.2);
        }
        50% {
          box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 0 30px rgba(0, 0, 0, 0.3);
        }
      }

      .casa.tema {
        background: linear-gradient(
          135deg,
          rgba(153, 129, 252, 0.98),
          rgba(183, 129, 252, 0.95)
        );
        color: #fff;
        border-color: rgba(123, 93, 255, 0.9);
      }

      .casa.sorte {
        background: linear-gradient(
          135deg,
          rgba(96, 245, 197, 0.98),
          rgba(51, 223, 176, 0.95)
        );
        color: #063932;
        border-color: rgba(51, 223, 176, 0.9);
      }

      .casa.reves {
        background: linear-gradient(
          135deg,
          rgba(255, 157, 180, 0.98),
          rgba(255, 123, 176, 0.95)
        );
        border-color: rgba(255, 123, 176, 0.9);
      }

      .casa.inicio {
        background: linear-gradient(
          135deg,
          rgba(200, 200, 255, 0.98),
          rgba(170, 170, 255, 0.95)
        );
        border-color: rgba(123, 93, 255, 0.9);
        font-weight: 600;
      }

      .casa.normal {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.98),
          rgba(240, 240, 255, 0.95)
        );
        border-color: rgba(180, 180, 200, 0.8);
      }

      .casa.meta {
        background: linear-gradient(135deg, #ffe766, #ffb347);
        color: #422608;
        font-weight: 700;
        border-color: rgba(255, 180, 0, 1);
        box-shadow: 0 6px 20px rgba(255, 180, 0, 0.5);
      }

      .casa .numero {
        position: absolute;
        top: 4px;
        right: 6px;
        font-size: 11px;
        font-weight: bold;
        color: rgba(0, 0, 0, 0.5);
        background: rgba(255, 255, 255, 0.7);
        padding: 3px 7px;
        border-radius: 8px;
        min-width: 24px;
        text-align: center;
      }

      .casa strong {
        font-size: 13px;
        margin-bottom: 3px;
        text-align: center;
      }

      .casa small {
        font-size: 10px;
        opacity: 0.9;
        text-align: center;
      }

      /* Adiciona setas direcionais para indicar o caminho em zigue-zague */
      .casa::after {
        content: '‚Üí';
        position: absolute;
        bottom: 4px;
        right: 8px;
        font-size: 18px;
        opacity: 0.3;
        font-weight: bold;
      }

      /* Linha 1 (casas 1-5): direita ‚Üí */
      .casa:nth-child(1)::after,
      .casa:nth-child(2)::after,
      .casa:nth-child(3)::after,
      .casa:nth-child(4)::after {
        content: '‚Üí';
      }

      /* Final da linha 1: desce ‚Üì */
      .casa:nth-child(5)::after {
        content: '‚Üì';
      }

      /* Linha 2 (casas 6-10): esquerda ‚Üê */
      .casa:nth-child(6)::after,
      .casa:nth-child(7)::after,
      .casa:nth-child(8)::after,
      .casa:nth-child(9)::after {
        content: '‚Üê';
      }

      /* Final da linha 2: desce ‚Üì */
      .casa:nth-child(10)::after {
        content: '‚Üì';
      }

      /* Linha 3 (casas 11-15): direita ‚Üí */
      .casa:nth-child(11)::after,
      .casa:nth-child(12)::after,
      .casa:nth-child(13)::after,
      .casa:nth-child(14)::after {
        content: '‚Üí';
      }

      /* Final da linha 3: desce ‚Üì */
      .casa:nth-child(15)::after {
        content: '‚Üì';
      }

      /* Linha 4 (casas 16-20): esquerda ‚Üê */
      .casa:nth-child(16)::after,
      .casa:nth-child(17)::after,
      .casa:nth-child(18)::after,
      .casa:nth-child(19)::after {
        content: '‚Üê';
      }

      /* Final da linha 4: desce ‚Üì */
      .casa:nth-child(20)::after {
        content: '‚Üì';
      }

      /* Linha 5 (casas 21-25): direita ‚Üí */
      .casa:nth-child(21)::after,
      .casa:nth-child(22)::after,
      .casa:nth-child(23)::after,
      .casa:nth-child(24)::after {
        content: '‚Üí';
      }

      /* Final da linha 5: desce ‚Üì */
      .casa:nth-child(25)::after {
        content: '‚Üì';
      }

      /* Linha 6 (casas 26-30): esquerda ‚Üê */
      .casa:nth-child(26)::after,
      .casa:nth-child(27)::after,
      .casa:nth-child(28)::after,
      .casa:nth-child(29)::after {
        content: '‚Üê';
      }

      /* Final da linha 6: desce ‚Üì */
      .casa:nth-child(30)::after {
        content: '‚Üì';
      }

      /* Linha 7 (casas 31-35): direita ‚Üí */
      .casa:nth-child(31)::after,
      .casa:nth-child(32)::after,
      .casa:nth-child(33)::after,
      .casa:nth-child(34)::after {
        content: '‚Üí';
      }

      /* Final da linha 7: desce ‚Üì */
      .casa:nth-child(35)::after {
        content: '‚Üì';
      }

      /* Linha 8 (casas 36-40): esquerda ‚Üê */
      .casa:nth-child(36)::after,
      .casa:nth-child(37)::after,
      .casa:nth-child(38)::after,
      .casa:nth-child(39)::after {
        content: '‚Üê';
      }

      .casa.meta::after {
        content: 'üéØ';
        opacity: 0.5;
      }

      .piao-area {
        margin-top: 6px;
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .piao {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        border: 3px solid rgba(255, 255, 255, 0.95);
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.35);
        overflow: hidden;
        background: #fff;
      }

      .piao img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      aside > div {
        background: rgba(255, 255, 255, 0.94);
        border-radius: 20px;
        padding: 14px;
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 18px 24px rgba(80, 62, 131, 0.14);
        margin-bottom: 10px;
      }

      /* Destaque do status do turno */
      .mensagens #statusTurno {
        padding: 12px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.5);
        border: 3px solid transparent;
        transition: all 0.3s ease;
        text-align: center;
        font-size: 16px;
      }

      .controle-dados {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 12px;
      }

      .controle-dados #rolarDados {
        width: 100%;
        padding: 16px;
        font-size: 18px;
      }

      .controle-dados .dado-visivel {
        width: 100px;
        height: 100px;
        font-size: 42px;
      }

      .carta-atual {
        border-radius: 16px;
        padding: 12px;
        min-height: 110px;
        border: 1px dashed rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      /* Anima√ß√£o piscante para carta nova */
      .carta-atual.carta-nova {
        animation: piscarCarta 1.5s ease-in-out 3;
      }

      @keyframes piscarCarta {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 rgba(0, 0, 0, 0);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 30px currentColor;
        }
      }

      .carta-atual.sorte-card {
        background: linear-gradient(135deg, #c2ffe2, #7dffd7);
        border-color: transparent;
        color: #053830;
      }

      .carta-atual.reves-card {
        background: linear-gradient(135deg, #ffd4df, #ff99c2);
        border-color: transparent;
        color: #5c0f2d;
      }

      .historico {
        transition: all 0.3s ease;
      }

      .historico h3 {
        cursor: pointer;
        user-select: none;
        margin-bottom: 8px;
      }

      .historico h3::after {
        content: ' ‚ñº';
        font-size: 0.8em;
        transition: transform 0.3s ease;
        display: inline-block;
      }

      .historico.collapsed h3::after {
        transform: rotate(-90deg);
      }

      .historico ul {
        max-height: 200px;
        overflow-y: auto;
        margin: 0;
        padding-left: 18px;
        transition: max-height 0.3s ease, opacity 0.3s ease;
      }

      .historico.collapsed ul {
        max-height: 0;
        opacity: 0;
        overflow: hidden;
      }

      /* Destaque do feed com cores da casa */
      .mensagens#feedJogo {
        transition: all 0.4s ease;
        border: 2px solid rgba(255, 255, 255, 0.6);
      }

      @media (max-width: 1100px) {
        .game-area {
          grid-template-columns: 1fr;
        }

        .mapa-real {
          aspect-ratio: 4 / 3;
        }

        aside {
          order: 2;
        }

        .mapa-wrapper {
          order: 1;
        }
      }
    </style>
  </head>
  <body>
    <section class="setup">
      <div style="grid-column: 1 / -1; text-align: center">
        <h1>Corrida Sprunk</h1>
        <p class="descricao">
          Conduza dois performers sprunkis por um circuito sinuoso lan√ßando
          dados, encarando casas tem√°ticas e cartas surpresa at√© chegar ao
          Grande Palco.
        </p>
        <p class="tag-percurso">
          Categoria: <strong>Jogo de Percurso</strong> (roll and move)
        </p>
      </div>
      <div class="player-config">
        <h2>Jogador 1</h2>
        <p>Escolha um performer Sprunk.</p>
        <div
          class="personagem-grid"
          id="lista1"
        ></div>
        <div
          class="preview-card"
          id="preview1"
        >
          <span>Selecione um personagem.</span>
        </div>
      </div>
      <div class="player-config">
        <h2>Jogador 2</h2>
        <p>Escolha outro performer.</p>
        <div
          class="personagem-grid"
          id="lista2"
        ></div>
        <div
          class="preview-card"
          id="preview2"
        >
          <span>Selecione um personagem.</span>
        </div>
      </div>
      <div class="setup-actions">
        <button
          id="iniciarJogo"
          disabled
          >Iniciar Partida</button
        >
      </div>
    </section>

    <section class="painel-principal hidden">
      <div class="game-area">
        <aside>
          <div class="controle-dados">
            <button
              id="rolarDados"
              disabled
              >üé≤ Lan√ßar Dados</button
            >
            <div
              class="dado-visivel"
              id="valorDado"
              >-</div
            >
          </div>
          <div class="mensagens">
            <h3>Status do Turno</h3>
            <p
              id="statusTurno"
              style="margin: 0; font-size: 14px"
            >
              Aguarde a escolha e confirme a partida.
            </p>
          </div>
          <div
            class="mensagens"
            id="feedJogo"
          >
            <h3>Feed de jogo</h3>
            <p
              id="mensagem"
              style="margin: 0"
              >Selecione dois performers para liberar o tabuleiro.</p
            >
          </div>
          <div class="cartas">
            <h3>Carta sorteada</h3>
            <div
              class="carta-atual"
              id="cartaAtual"
            >
              <strong id="cartaTipo">Nenhuma carta ainda</strong>
              <p id="cartaTexto"
                >Caia em casas de Sorte ou Rev√©s para revelar.</p
              >
            </div>
          </div>
          <div class="historico collapsed">
            <h3>Linha do tempo</h3>
            <ul id="historico"></ul>
          </div>
        </aside>
        <div class="mapa-wrapper">
          <div class="mapa-real">
            <div id="tabuleiro"></div>
          </div>
        </div>
      </div>
    </section>

    <script>
      const personagens = [
        {
          id: 'Orange',
          nome: 'Orange',
          apelido: 'Oren',
          sigla: 'OR',
          cor: '#ff8a00',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/3/3c/Orensvg.svg/revision/latest/scale-to-width-down/131?cb=20241105133516',
        },
        {
          id: 'Red',
          nome: 'Red',
          apelido: 'Raddy',
          sigla: 'RD',
          cor: '#ff4b4b',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/a/a2/Raddysvg.svg/revision/latest/scale-to-width-down/126?cb=20241105133516',
        },
        {
          id: 'Silver',
          nome: 'Silver',
          apelido: 'Clukr',
          sigla: 'SI',
          cor: '#d4d9e7',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/b/bb/Clukersvg.svg/revision/latest/scale-to-width-down/127?cb=20241215194356',
        },
        {
          id: 'Wenda',
          nome: 'Wenda',
          apelido: 'Wenda',
          sigla: 'WE',
          cor: '#ffffff',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/d/d2/Wendasvg.svg/revision/latest?cb=20241105133513',
        },
        {
          id: 'Green',
          nome: 'Green',
          apelido: 'Vineria',
          sigla: 'GR',
          cor: '#35d894',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/0/0e/Vinerasvg.svg/revision/latest/scale-to-width-down/102?cb=20241105133511',
        },
        {
          id: 'Sky_Blue',
          nome: 'Sky Blue',
          apelido: 'Sky',
          sigla: 'SK',
          cor: '#7ec8ff',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/8/8b/Sky.svg/revision/latest/scale-to-width-down/103?cb=20241128191459',
        },
        {
          id: 'Purple',
          nome: 'Purple',
          apelido: 'Durple',
          sigla: 'PR',
          cor: '#b384ff',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/f/ff/Durplesvg.svg/revision/latest/scale-to-width-down/101?cb=20241105133512',
        },
        {
          id: 'Yellow',
          nome: 'Yellow',
          apelido: 'Simon',
          sigla: 'YL',
          cor: '#ffeb52',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/6/62/Simonsvg.svg/revision/latest/scale-to-width-down/130?cb=20241105133512',
        },
        {
          id: 'Pink',
          nome: 'Pink',
          apelido: 'Pinki',
          sigla: 'PK',
          cor: '#ff7ab8',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/5/54/Pinki.svg/revision/latest/scale-to-width-down/84?cb=20241128060048',
        },
        {
          id: 'Blue',
          nome: 'Blue',
          apelido: 'Jevin',
          sigla: 'BL',
          cor: '#4a90ff',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/7/70/Jevinsvg.svg/revision/latest/scale-to-width-down/109?cb=20241105133513',
        },
        {
          id: 'Black',
          nome: 'Black',
          apelido: 'Black Sprunki',
          sigla: 'BK',
          cor: '#23232e',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/d/d5/Blacksvg.svg/revision/latest/scale-to-width-down/103?cb=20241105133516',
        },
        {
          id: 'Gold',
          nome: 'Gold',
          apelido: 'Garnold',
          sigla: 'GD',
          cor: '#f6c350',
          imagem:
            'https://static.wikia.nocookie.net/incredibox-sprunki/images/0/0c/Garnoldsvg.svg/revision/latest/scale-to-width-down/110?cb=20241105133511',
        },
      ];

      const casas = [
        { titulo: 'Spawn', descricao: 'In√≠cio', tipo: 'inicio' },
        { titulo: 'Sprunk Stage', descricao: 'Luzes verdes', tipo: 'tema' },
        { titulo: 'Bass Tunnel', descricao: 'Pulso empurra', tipo: 'tema' },
        { titulo: 'Sorte Neon', descricao: 'Carta sorte', tipo: 'sorte' },
        { titulo: 'Glitch Lane', descricao: 'Ch√£o some!', tipo: 'reves' },

        { titulo: 'Mix Lab', descricao: 'Ajuste suave', tipo: 'tema' },
        { titulo: 'Beat Street', descricao: 'Desfile', tipo: 'normal' },
        { titulo: 'Cartas Sprunk', descricao: 'Aleat√≥rio', tipo: 'sorte' },
        { titulo: 'Neblina', descricao: 'Fuma√ßa atrasa', tipo: 'reves' },
        { titulo: 'Groove Plaza', descricao: 'Respire', tipo: 'normal' },

        { titulo: 'Solo Legend', descricao: 'Solo √©pico', tipo: 'tema' },
        { titulo: 'Drop Zone', descricao: 'Queda livre', tipo: 'normal' },
        { titulo: 'Neon Falls', descricao: 'Descida', tipo: 'tema' },
        { titulo: 'Card Sorte', descricao: 'Fortuna volta', tipo: 'sorte' },
        { titulo: 'Batalha', descricao: 'Recue!', tipo: 'reves' },

        { titulo: 'Lounge Vapor', descricao: 'Descanso', tipo: 'tema' },
        { titulo: 'Remix Point', descricao: 'Recombine', tipo: 'normal' },
        { titulo: 'Card Rev√©s', descricao: 'Palco apagou', tipo: 'reves' },
        { titulo: 'Holo-Bridge', descricao: 'Ponte luz', tipo: 'tema' },
        { titulo: 'Sprunk Loop', descricao: 'Velocidade', tipo: 'sorte' },

        { titulo: 'Eco Perdido', descricao: 'Volta beat', tipo: 'reves' },
        { titulo: 'Neon Market', descricao: 'Troca', tipo: 'normal' },
        { titulo: 'Synth Wave', descricao: 'Ondas sonoras', tipo: 'tema' },
        { titulo: 'VR Session', descricao: 'Treino', tipo: 'sorte' },
        { titulo: 'Feedback Loop', descricao: 'Eco infinito', tipo: 'reves' },

        { titulo: 'Cabos Emaranhados', descricao: 'Desenrolar', tipo: 'reves' },
        { titulo: 'Back to Beat', descricao: 'Casa neutra', tipo: 'normal' },
        { titulo: 'Auto-Tune', descricao: 'Corre√ß√£o', tipo: 'tema' },
        { titulo: 'Lucky Star', descricao: 'Estrela sorte', tipo: 'sorte' },
        { titulo: 'Static Noise', descricao: 'Interfer√™ncia', tipo: 'reves' },

        { titulo: 'Harmony Hall', descricao: 'Sincronia', tipo: 'tema' },
        { titulo: 'Sample Street', descricao: 'Coleta sons', tipo: 'normal' },
        { titulo: 'Power Chord', descricao: 'Energia pura', tipo: 'tema' },
        { titulo: 'Encore Time', descricao: 'Bis surpresa', tipo: 'sorte' },
        { titulo: 'Broken Mic', descricao: 'Mic quebrado', tipo: 'reves' },

        { titulo: 'Sound Check', descricao: 'Teste de som', tipo: 'normal' },
        { titulo: 'Final Mix', descricao: '√öltimo ajuste', tipo: 'tema' },
        { titulo: 'Golden Ticket', descricao: 'Passe VIP', tipo: 'sorte' },
        { titulo: 'Backstage', descricao: 'Quase l√°!', tipo: 'normal' },
        { titulo: 'üé§ PALCO', descricao: 'VIT√ìRIA!', tipo: 'meta' },
      ];

      const cartasSorte = [
        {
          texto: 'Drop perfeito! Avance 3 casas.',
          efeito: (jogador) => moverExtra(jogador, 3),
        },
        {
          texto: 'Chuva de Sprunk. Avance 2 ou fa√ßa o rival voltar 1.',
          efeito: (jogador) => escolhaJogador(jogador, 2, 1),
        },
        {
          texto: 'Loop impec√°vel: jogue novamente ap√≥s mover.',
          efeito: (jogador) => (jogador.bonusTurno = true),
        },
        {
          texto: 'Coro do p√∫blico garante um escudo.',
          efeito: (jogador) => (jogador.escudo = true),
        },
      ];

      const cartasReves = [
        {
          texto: 'Cabo desconectado! Volte 2 casas.',
          efeito: (jogador) => moverExtra(jogador, -2),
        },
        {
          texto: 'Escorregou em Sprunk derramado. Perde a pr√≥xima vez.',
          efeito: (jogador) => (jogador.pularProxima = true),
        },
        {
          texto: 'Beat travado: volte ao √∫ltimo tema visitado.',
          efeito: (jogador) => voltarUltimoTema(jogador),
        },
        {
          texto: 'Microfone chiando: o pr√≥ximo valor vale s√≥ metade.',
          efeito: (jogador) => (jogador.penalidade = true),
        },
      ];

      const jogadores = [
        { nome: 'Jogador 1', personagem: null, cor: '#fff', posicao: 0 },
        { nome: 'Jogador 2', personagem: null, cor: '#fff', posicao: 0 },
      ];

      const escolhas = [null, null];
      let jogoIniciado = false;
      let jogadorAtual = 0;
      let animando = false;

      const seletores = [
        document.getElementById('lista1'),
        document.getElementById('lista2'),
      ];
      const previews = [
        document.getElementById('preview1'),
        document.getElementById('preview2'),
      ];
      const setupSection = document.querySelector('.setup');
      const painelPrincipal = document.querySelector('.painel-principal');
      const iniciarBtn = document.getElementById('iniciarJogo');
      const rolarBtn = document.getElementById('rolarDados');
      const valorDado = document.getElementById('valorDado');
      const statusTurno = document.getElementById('statusTurno');
      const mensagem = document.getElementById('mensagem');
      const historico = document.getElementById('historico');
      const cartaPainel = document.getElementById('cartaAtual');
      const cartaTipo = document.getElementById('cartaTipo');
      const cartaTexto = document.getElementById('cartaTexto');

      function montarSeletores() {
        seletores.forEach((container, idx) => {
          container.innerHTML = '';
          personagens.forEach((personagem) => {
            const card = document.createElement('button');
            card.type = 'button';
            card.className = 'personagem-card';
            card.dataset.personagem = personagem.id;
            card.innerHTML = `
              <img src="${personagem.imagem}" alt="${personagem.nome}" />
              <strong>${personagem.nome}</strong>
              <small>${personagem.apelido}</small>
            `;
            card.addEventListener('click', () =>
              escolherPersonagem(idx, personagem)
            );
            container.appendChild(card);
          });
        });
      }

      function escolherPersonagem(idx, personagem) {
        if (jogoIniciado) return;
        const rivalIdx = idx === 0 ? 1 : 0;
        if (escolhas[rivalIdx]?.id === personagem.id) {
          mensagem.textContent = `${personagem.nome} j√° foi escolhido pelo rival.`;
          return;
        }
        escolhas[idx] = personagem;
        atualizarSelecaoVisual();
        atualizarPreview(idx);
        validarSelecao();
      }

      function atualizarSelecaoVisual() {
        seletores.forEach((container, idx) => {
          const rivalIdx = idx === 0 ? 1 : 0;
          container.querySelectorAll('.personagem-card').forEach((card) => {
            const id = card.dataset.personagem;
            card.classList.toggle('selected', escolhas[idx]?.id === id);
            const bloqueado = escolhas[rivalIdx]?.id === id;
            card.classList.toggle('bloqueado', Boolean(bloqueado));
            card.disabled = Boolean(bloqueado);
          });
        });
      }

      function atualizarPreview(idx) {
        const preview = previews[idx];
        const escolha = escolhas[idx];
        if (!escolha) {
          preview.innerHTML = '<span>Selecione um personagem.</span>';
          preview.style.borderColor = 'rgba(0,0,0,0.1)';
          return;
        }
        preview.innerHTML = `
          <img src="${escolha.imagem}" alt="${escolha.nome}" />
          <div>
            <strong>${escolha.nome}</strong>
            <small>${escolha.apelido}</small>
          </div>
        `;
        preview.style.borderColor = escolha.cor;
      }

      function validarSelecao() {
        const ambosEscolhidos = escolhas.every(Boolean);
        iniciarBtn.disabled = !ambosEscolhidos;
        if (ambosEscolhidos) {
          mensagem.textContent =
            'Pronto! Clique em "Iniciar Partida" para come√ßar.';
        }
      }

      iniciarBtn.addEventListener('click', () => {
        if (!escolhas.every(Boolean)) return;
        jogadores.forEach((jogador, idx) => {
          const personagem = escolhas[idx];
          jogador.personagem = personagem;
          jogador.cor = personagem.cor;
          jogador.posicao = 0;
          jogador.escudo = false;
          jogador.pularProxima = false;
          jogador.bonusTurno = false;
          jogador.penalidade = false;
        });
        jogoIniciado = true;
        jogadorAtual = 0;
        iniciarBtn.disabled = true;
        setupSection.classList.add('hidden');
        painelPrincipal.classList.remove('hidden');
        mensagem.textContent =
          'Partida iniciada! Lance os dados para andar na trilha.';
        historico.innerHTML = '';
        valorDado.textContent = '-';
        resetCartaPainel();
        rolarBtn.disabled = false;
        atualizarStatus();
        atualizarTabuleiro();
        atualizarFeedDestaque();
        registrar(
          `${jogadores[0].personagem.nome} vs ${jogadores[1].personagem.nome} come√ßou!`
        );
      });

      rolarBtn.addEventListener('click', async () => {
        if (!jogoIniciado || animando) return;
        const jogador = jogadores[jogadorAtual];
        if (jogador.pularProxima) {
          registrar(`${jogador.personagem.nome} perde a vez por rev√©s.`);
          jogador.pularProxima = false;
          avancarTurno();
          return;
        }

        animando = true;
        rolarBtn.disabled = true;
        const valor = await animarDado();
        const passos = jogador.penalidade
          ? Math.max(1, Math.floor(valor / 2))
          : valor;
        jogador.penalidade = false;
        valorDado.textContent = passos;
        registrar(
          `${jogador.personagem.nome} tirou ${valor} e avan√ßa ${passos}.`
        );
        await moverJogador(jogador, passos);
        verificarCasa(jogador);

        if (jogador.posicao >= casas.length - 1) {
          mensagem.textContent = `${jogador.personagem.nome} chegou ao Grande Palco!`;
          registrar(`${jogador.personagem.nome} venceu a corrida Sprunk!`);
          rolarBtn.disabled = true;
          animando = false;
          return;
        }

        if (jogador.bonusTurno) {
          registrar(`${jogador.personagem.nome} ganhou um turno extra.`);
          jogador.bonusTurno = false;
          animando = false;
          rolarBtn.disabled = false;
          atualizarStatus('‚Äî turno b√¥nus!');
          return;
        }

        animando = false;
        avancarTurno();
      });

      function resetCartaPainel() {
        cartaPainel.className = 'carta-atual';
        cartaTipo.textContent = 'Nenhuma carta ainda';
        cartaTexto.textContent =
          'Caia em casas de Sorte ou Rev√©s para revelar.';
      }

      async function animarDado() {
        const roll = () => Math.floor(Math.random() * 6) + 1;
        for (let i = 0; i < 10; i++) {
          valorDado.textContent = roll();
          await esperar(90);
        }
        return roll();
      }

      function esperar(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }

      async function moverJogador(jogador, passos) {
        const destino = Math.min(jogador.posicao + passos, casas.length - 1);
        while (jogador.posicao < destino) {
          jogador.posicao++;
          mensagem.textContent = `${jogador.personagem.nome} alcan√ßou ${
            casas[jogador.posicao].titulo
          }.`;
          atualizarTabuleiro();
          await esperar(240);
        }
      }

      function moverExtra(jogador, delta) {
        jogador.posicao = Math.min(
          Math.max(jogador.posicao + delta, 0),
          casas.length - 1
        );
        atualizarTabuleiro();
      }

      function voltarUltimoTema(jogador) {
        if (jogador.escudo) {
          registrar('Escudo ativado! Nenhum rev√©s aplicado.');
          jogador.escudo = false;
          return;
        }
        for (let i = jogador.posicao; i >= 0; i--) {
          if (casas[i].tipo === 'tema') {
            jogador.posicao = i;
            atualizarTabuleiro();
            return;
          }
        }
        jogador.posicao = 0;
        atualizarTabuleiro();
      }

      function escolhaJogador(jogador, bonus, penalidade) {
        const resposta = confirm(
          `${jogador.personagem.nome}: Avan√ßar ${bonus} casas? (Cancelar = rival recua ${penalidade})`
        );
        if (resposta) {
          moverExtra(jogador, bonus);
        } else {
          const rival = jogadores[jogadorAtual === 0 ? 1 : 0];
          moverExtra(rival, -penalidade);
          registrar(`${rival.personagem.nome} recuou ${penalidade}.`);
        }
      }

      // Fun√ß√£o para atualizar destaque do feed com cores da casa atual
      function atualizarFeedDestaque() {
        const feedJogo = document.getElementById('feedJogo');
        if (!jogoIniciado || !jogadores[jogadorAtual]?.personagem) {
          return;
        }

        const jogador = jogadores[jogadorAtual];
        const casaAtual = casas[jogador.posicao];

        // Define cores baseadas no tipo de casa
        const coresCasa = {
          tema: '#9981fc',
          sorte: '#60f5c5',
          reves: '#ff9db4',
          normal: '#ffffff',
        };

        const corCasa = coresCasa[casaAtual.tipo] || coresCasa.normal;

        feedJogo.style.borderColor = corCasa;
        feedJogo.style.backgroundColor = '#ffffff';
        feedJogo.style.boxShadow = `0 0 20px ${corCasa}50`;
      }

      function verificarCasa(jogador) {
        const casaAtual = casas[jogador.posicao];
        mensagem.textContent = `${jogador.personagem.nome} est√° em ${casaAtual.titulo}.`;

        // Atualiza destaque do feed com cor da casa atual
        atualizarFeedDestaque();

        if (casaAtual.tipo === 'sorte') {
          aplicarCarta(jogador, cartasSorte, 'Sorte');
        } else if (casaAtual.tipo === 'reves') {
          if (jogador.escudo) {
            registrar('Escudo protegeu do rev√©s.');
            jogador.escudo = false;
            return;
          }
          aplicarCarta(jogador, cartasReves, 'Rev√©s');
        }
      }

      function aplicarCarta(jogador, baralho, tipo) {
        const carta = baralho[Math.floor(Math.random() * baralho.length)];
        cartaPainel.className = 'carta-atual';
        cartaPainel.classList.add(
          tipo === 'Sorte' ? 'sorte-card' : 'reves-card'
        );
        // Adiciona anima√ß√£o piscante
        cartaPainel.classList.add('carta-nova');
        setTimeout(() => cartaPainel.classList.remove('carta-nova'), 4500);

        cartaTipo.textContent = `${tipo} de ${jogador.personagem.nome}`;
        cartaTexto.textContent = carta.texto;
        registrar(`${tipo} para ${jogador.personagem.nome}: ${carta.texto}`);
        carta.efeito(jogador);
        atualizarTabuleiro();
      }

      function avancarTurno() {
        jogadorAtual = jogadorAtual === 0 ? 1 : 0;
        atualizarStatus();
        atualizarFeedDestaque();
        rolarBtn.disabled = false;
      }

      function atualizarStatus(extra = '') {
        const jogador = jogadores[jogadorAtual];
        statusTurno.textContent = `Vez de ${
          jogador.personagem?.nome || '...'
        } ${extra}`;

        // Adiciona destaque com cor do personagem ao status
        if (jogador.personagem) {
          const cor = jogador.personagem.cor;

          // Garante contraste usando texto branco com sombra escura
          statusTurno.style.color = '#ffffff';
          statusTurno.style.fontWeight = 'bold';
          statusTurno.style.textShadow = `0 2px 4px rgba(0,0,0,0.8), 0 0 10px rgba(0,0,0,0.5)`;
          statusTurno.style.borderColor = cor;
          statusTurno.style.backgroundColor = `${cor}90`;
          statusTurno.style.boxShadow = `0 0 20px ${cor}60, inset 0 0 20px ${cor}40`;
        } else {
          statusTurno.style.color = '';
          statusTurno.style.fontWeight = '';
          statusTurno.style.textShadow = '';
          statusTurno.style.borderColor = 'transparent';
          statusTurno.style.backgroundColor = 'rgba(255, 255, 255, 0.5)';
          statusTurno.style.boxShadow = '';
        }
      }

      function registrar(texto) {
        const li = document.createElement('li');
        li.textContent = texto;
        historico.prepend(li);
        while (historico.childElementCount > 12) {
          historico.lastChild.remove();
        }
      }

      function atualizarTabuleiro() {
        // Limpa todas as √°reas de pi√µes e remove classes de jogador presente
        document
          .querySelectorAll('.piao-area')
          .forEach((area) => (area.innerHTML = ''));
        document.querySelectorAll('.casa').forEach((casa) => {
          casa.classList.remove('jogador-presente-1', 'jogador-presente-2');
          casa.style.borderColor = '';
          casa.style.borderImage = '';
        });

        // Agrupa jogadores por posi√ß√£o
        const jogadoresPorPosicao = {};
        jogadores.forEach((jogador, idx) => {
          if (!jogador.personagem) return;
          const pos = jogador.posicao;
          if (!jogadoresPorPosicao[pos]) {
            jogadoresPorPosicao[pos] = [];
          }
          jogadoresPorPosicao[pos].push({ jogador, idx });
        });

        // Aplica estilos e pi√µes
        Object.keys(jogadoresPorPosicao).forEach((pos) => {
          const casaEl = document.querySelector(`.casa[data-ordem="${pos}"]`);
          if (!casaEl) return;

          const jogadoresNaCasa = jogadoresPorPosicao[pos];

          if (jogadoresNaCasa.length === 1) {
            // Um jogador - borda com cor do personagem
            const cor = jogadoresNaCasa[0].jogador.personagem.cor;
            casaEl.classList.add('jogador-presente-1');
            casaEl.style.borderColor = cor;
          } else if (jogadoresNaCasa.length === 2) {
            // Dois jogadores - borda dividida
            const cor1 = jogadoresNaCasa[0].jogador.personagem.cor;
            const cor2 = jogadoresNaCasa[1].jogador.personagem.cor;
            casaEl.classList.add('jogador-presente-2');
            casaEl.style.borderImage = `linear-gradient(135deg, ${cor1} 0%, ${cor1} 50%, ${cor2} 50%, ${cor2} 100%) 1`;
          }

          // Adiciona os pi√µes
          const piaoArea = casaEl.querySelector('.piao-area');
          if (!piaoArea) return;

          jogadoresNaCasa.forEach(({ jogador }) => {
            const token = document.createElement('div');
            token.className = 'piao';
            const img = document.createElement('img');
            img.src = jogador.personagem.imagem;
            img.alt = jogador.personagem.nome;
            token.appendChild(img);
            piaoArea.appendChild(token);
          });
        });
      }

      function montarTabuleiro() {
        const tabuleiro = document.getElementById('tabuleiro');
        tabuleiro.innerHTML = '';
        casas.forEach((casa, indice) => {
          const div = document.createElement('div');
          div.className = `casa ${casa.tipo || ''}`;
          div.dataset.ordem = indice;
          const numero = document.createElement('span');
          numero.className = 'numero';
          numero.textContent = indice + 1;
          const titulo = document.createElement('strong');
          titulo.textContent = casa.titulo;
          const desc = document.createElement('small');
          desc.textContent = casa.descricao;
          const piaoArea = document.createElement('div');
          piaoArea.className = 'piao-area';
          div.append(numero, titulo, desc, piaoArea);
          tabuleiro.appendChild(div);
        });
      }

      // Toggle da linha do tempo
      document.querySelector('.historico h3').addEventListener('click', () => {
        document.querySelector('.historico').classList.toggle('collapsed');
      });

      montarSeletores();
      montarTabuleiro();
      atualizarTabuleiro();
    </script>
  </body>
</html>
